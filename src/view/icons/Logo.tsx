import React from 'react'
import {StyleSheet, type TextProps} from 'react-native'
import Svg, {
  Defs,
  G,
  LinearGradient,
  Path,
  type PathProps,
  Stop,
  type SvgProps,
} from 'react-native-svg'
import {Image} from 'expo-image'

import {colors} from '#/lib/styles'
import {useKawaiiMode} from '#/state/preferences/kawaii'

const ratio = 57 / 64

type Props = {
  fill?: PathProps['fill']
  style?: TextProps['style']
} & Omit<SvgProps, 'style'>

export const Logo = React.forwardRef(function LogoImpl(props: Props, ref) {
  const {fill, ...rest} = props
  const gradient = fill === 'sky'
  const styles = StyleSheet.flatten(props.style)
  const _fill = gradient ? 'url(#sky)' : fill || styles?.color || colors.blue3
  // @ts-ignore it's fiiiiine
  const size = parseInt(rest.width || 32)

  const isKawaii = useKawaiiMode()

  if (isKawaii) {
    return (
      <Image
        source={
          size > 100
            ? require('../../../assets/kawaii.png')
            : require('../../../assets/kawaii_smol.png')
        }
        accessibilityLabel="Bluesky"
        accessibilityHint=""
        accessibilityIgnoresInvertColors
        style={[{height: size, aspectRatio: 1.4}]}
      />
    )
  }

  return (
    <Svg
      fill="none"
      // @ts-ignore it's fiiiiine
      ref={ref}
      viewBox="0 0 64 57"
      {...rest}
      style={[{width: size, height: size * ratio}, styles]}>
      {gradient && (
        <Defs>
          <LinearGradient id="sky" x1="0" y1="0" x2="0" y2="1">
            <Stop offset="0" stopColor="#0A7AFF" stopOpacity="1" />
            <Stop offset="1" stopColor="#59B9FF" stopOpacity="1" />
          </LinearGradient>
        </Defs>
      )}

      <G stroke="none" strokeWidth={1} fill="none" fillRule="evenodd">
        <Path
          d="M15.383 0h26.234c5.349 0 7.289.557 9.244 1.603a10.904 10.904 0 014.536 4.536C56.443 8.094 57 10.034 57 15.383v26.234c0 5.349-.557 7.289-1.603 9.244a10.904 10.904 0 01-4.536 4.536C48.906 56.443 46.966 57 41.617 57H15.383c-5.349 0-7.289-.557-9.244-1.603a10.904 10.904 0 01-4.536-4.536C.557 48.906 0 46.966 0 41.617V15.383c0-5.349.557-7.289 1.603-9.244a10.904 10.904 0 014.536-4.536C8.094.557 10.034 0 15.383 0z"
          fill="#C22EFF"
        />
        <G fill="#FFE6D5" fillRule="nonzero">
          <Path
            d="M43.098 23.513c0-4.447-3.608-8.065-8.043-8.065-2.83 0-5.32 1.478-6.753 3.7-1.433-2.222-3.922-3.7-6.752-3.7-2.831 0-5.32 1.478-6.754 3.701-1.434-2.223-3.923-3.7-6.753-3.7C3.608 15.448 0 19.065 0 23.512c0 4.32 3.406 7.847 7.665 8.046a8.023 8.023 0 00-.912 3.715c0 4.303 3.381 7.82 7.617 8.044a8.021 8.021 0 00-.864 3.616c0 4.448 3.608 8.066 8.043 8.066 4.434 0 8.042-3.618 8.042-8.066a8.021 8.021 0 00-.864-3.616c4.236-.225 7.617-3.74 7.617-8.044a8.02 8.02 0 00-.91-3.715c4.258-.2 7.664-3.727 7.664-8.046zM21.55 18.035c3.012 0 5.463 2.458 5.463 5.478 0 3.021-2.45 5.479-5.463 5.479s-5.464-2.458-5.464-5.479c0-3.02 2.451-5.478 5.464-5.478zM2.58 23.513c0-3.02 2.451-5.478 5.463-5.478 3.013 0 5.464 2.458 5.464 5.478 0 3.021-2.451 5.479-5.464 5.479-3.012 0-5.463-2.458-5.463-5.479zm6.754 11.76c0-3.02 2.45-5.478 5.463-5.478 3.012 0 5.463 2.458 5.463 5.479 0 1.83-.904 3.45-2.283 4.446a8.096 8.096 0 00-.95.55 5.41 5.41 0 01-2.231.483c-3.012 0-5.462-2.458-5.462-5.48zm12.216 17.14c-3.013 0-5.464-2.458-5.464-5.479 0-1.83.903-3.449 2.282-4.444.33-.165.65-.345.95-.55a5.4 5.4 0 014.463 0c.301.205.621.385.95.55a5.473 5.473 0 012.282 4.444c0 3.021-2.451 5.48-5.463 5.48zm6.752-11.66c-.795 0-1.55-.175-2.23-.483a8.081 8.081 0 00-.95-.55 5.476 5.476 0 01-2.283-4.446c0-3.021 2.451-5.48 5.463-5.48s5.463 2.459 5.463 5.48c0 3.021-2.45 5.48-5.463 5.48zm6.753-11.762c-3.012 0-5.463-2.458-5.463-5.478 0-3.02 2.451-5.479 5.463-5.479 3.013 0 5.464 2.458 5.464 5.479 0 3.02-2.451 5.478-5.464 5.478zM23.232 14.727c6.363 0 8.11-5.316 8.145-8.126a1.293 1.293 0 00-1.244-1.307c-2.202-.07-4.323.746-5.885 2.307-1.445 1.444-2.308 3.625-2.308 5.834 0 .714.578 1.292 1.292 1.292zm2.844-5.3A5.284 5.284 0 0128.58 8.02c-.356 1.412-1.313 3.417-3.878 3.975.216-.896.646-1.84 1.374-2.566zM20.463 12.563c.716 0 1.297-.581 1.297-1.298C21.76 2.466 14.405.05 10.516.001 9.806-.026 9.23.547 9.204 1.25a10.952 10.952 0 003.185 8.126c1.994 1.996 5.012 3.187 8.074 3.187zm-1.38-2.703c-1.625-.248-3.485-.942-4.86-2.318a8.223 8.223 0 01-2.365-4.796c2.266.398 6.573 1.846 7.224 7.114z"
            transform="translate(7 .95)"
          />
        </G>
      </G>
      {/* <Path
        fill={_fill}
        d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805ZM50.127 3.805C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745Z"
      /> */}
    </Svg>
  )
})
